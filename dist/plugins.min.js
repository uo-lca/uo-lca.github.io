function ngGridFlexibleHeightPlugin(n){var t=this;t.grid=null,t.scope=null,t.init=function(r,e,i){t.domUtilityService=i.DomUtilityService,t.grid=e,t.scope=r;var o=function(){setTimeout(u,1)},u=function(){var r=t.grid.gridId,e="."+r+" .ngFooterPanel",i=t.grid.$topPanel.height()+$(e).height(),o=t.grid.$canvas.height()+1;null!=n&&(null!=n.minHeight&&n.minHeight>o+i&&(o=n.minHeight-i-2),null!=n.maxHeight&&o+i>n.maxHeight&&(o=n.maxHeight));var u=o+3;t.scope.baseViewportHeight&&t.scope.baseViewportHeight===u||(t.grid.$viewport.css("height",u+"px"),t.grid.$root.css("height",u+i+"px"),t.scope.baseViewportHeight=u,t.domUtilityService.RebuildGrid(t.scope,t.grid))};t.scope.catHashKeys=function(){var n,r="";for(n in t.scope.renderedRows)r+=t.scope.renderedRows[n].$$hashKey;return r},t.scope.$watch("catHashKeys()",u),t.scope.$watch(t.grid.config.data,o)}}d3.sankey=function(){function n(){d.forEach(function(n){n.sourceLinks=[],n.targetLinks=[]}),y.forEach(function(n){var t=n.source,r=n.target;"number"==typeof t&&(t=n.source=d[n.source]),"number"==typeof r&&(r=n.target=d[n.target]),t.sourceLinks.push(n),r.targetLinks.push(n)})}function t(){d.forEach(function(n){n.value=Math.max(d3.sum(n.sourceLinks,s),d3.sum(n.targetLinks,s))})}function r(){for(var n,t=d,r=0;t.length;)n=[],t.forEach(function(t){t.x=r,t.dx=f,t.sourceLinks.forEach(function(t){0>n.indexOf(t.target)&&n.push(t.target)})}),t=n,++r;e(r),i((h[0]-f)/(r-1))}function e(n){d.forEach(function(t){t.sourceLinks.length||(t.x=n-1)})}function i(n){d.forEach(function(t){t.x*=n})}function o(n){function t(){var n=d3.min(u,function(n){return(h[1]-(n.length-1)*g)/d3.sum(n,s)});u.forEach(function(t){t.forEach(function(t,r){t.y=r,t.dy=t.value*n})}),y.forEach(function(t){t.dy=t.value*n})}function r(n){function t(n){return c(n.source)*n.value}u.forEach(function(r){r.forEach(function(r){if(r.targetLinks.length){var e=d3.sum(r.targetLinks,t)/d3.sum(r.targetLinks,s);r.y+=(e-c(r))*n}})})}function e(n){function t(n){return c(n.target)*n.value}u.slice().reverse().forEach(function(r){r.forEach(function(r){if(r.sourceLinks.length){var e=d3.sum(r.sourceLinks,t)/d3.sum(r.sourceLinks,s);r.y+=(e-c(r))*n}})})}function i(){u.forEach(function(n){var t,r,e,i=0,u=n.length;for(n.sort(o),e=0;u>e;++e)t=n[e],r=i-t.y,r>0&&(t.y+=r),i=t.y+t.dy+g;if(r=i-g-h[1],r>0)for(i=t.y-=r,e=u-2;e>=0;--e)t=n[e],r=t.y+t.dy+g-i,r>0&&(t.y-=r),i=t.y})}function o(n,t){return n.y-t.y}var u=d3.nest().key(function(n){return n.x}).sortKeys(d3.ascending).entries(d).map(function(n){return n.values});t(),i();for(var a=1;n>0;--n)e(a*=.99),i(),r(a),i()}function u(){function n(n,t){return n.source.y-t.source.y}function t(n,t){return n.target.y-t.target.y}d.forEach(function(r){r.sourceLinks.sort(t),r.targetLinks.sort(n)}),d.forEach(function(n){var t=0,r=0;n.sourceLinks.forEach(function(n){n.sy=t,t+=n.dy}),n.targetLinks.forEach(function(n){n.ty=r,r+=n.dy})})}function c(n){return n.y+n.dy/2}function s(n){return n.value}var a={},f=24,g=8,h=[1,1],d=[],y=[];return a.nodeWidth=function(n){return arguments.length?(f=+n,a):f},a.nodePadding=function(n){return arguments.length?(g=+n,a):g},a.nodes=function(n){return arguments.length?(d=n,a):d},a.links=function(n){return arguments.length?(y=n,a):y},a.size=function(n){return arguments.length?(h=n,a):h},a.layout=function(e){return n(),t(),r(),o(e),u(),a},a.relayout=function(){return u(),a},a.link=function(){function n(n){var r=n.source.x+n.source.dx,e=n.target.x,i=d3.interpolateNumber(r,e),o=i(t),u=i(1-t),c=n.source.y+n.sy+n.dy/2,s=n.target.y+n.ty+n.dy/2;return"M"+r+","+c+"C"+o+","+c+" "+u+","+s+" "+e+","+s}var t=.5;return n.curvature=function(r){return arguments.length?(t=+r,n):t},n},a};